CREATE VIEW `vw_general_balance` AS with "incomes" as (select COALESCE(SUM(total), 0) as "total_incomes" from "vw_income_balance"), "expenses" as (select COALESCE(SUM(total), 0) as "total_expenses" from "vw_expense_balance") select incomes.total_incomes as "total_incomes", expenses.total_expenses as "total_expenses", incomes.total_incomes - expenses.total_expenses as "balance" from "incomes" left join "expenses" on 1=1;